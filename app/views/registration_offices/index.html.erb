<div class="grid-body">

  <div class="container column-left">
    <h1 class="registration-offices-header-text">Registration Offices in Berlin</h1>
    <% if current_user.appointments.any? %>
      <p>You've already booked an appointment.</p>
      <%= link_to 'See your appointment', appointment_path(current_user.appointments.first), class: 'btn btn-flat-even' %>
    <% else %>
    <p>Please choose your desired office for your registration in Berlin:</p>
      <ul>
        <% @registration_offices.each_with_index do |registration_office, index| %>
          <!-- Button trigger modal -->
          <button type="button" class="btn btn-flat-even" data-toggle="modal" data-target="#exampleModal<%= index %>">
            <%= registration_office.office_name %>
          </button>

        <!-- Modal -->
        <div class="modal fade" id="exampleModal<%= index %>" tabindex="-1" role="dialog" aria-labelledby="<%= index %>" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="example"> Please choose a free appointment with <%= registration_office.office_name %> and confirm with "Book"</h5>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>

              </div>

              <div class="modal-body text-center">
                <% counter = 0 %>
                <% registration_office.appointments.each do |appointment| %>
                  <% if appointment.not_booked? %>
                    <%= simple_form_for appointment do |f| %>
                      <input class="radio-button" type="radio" id="appointment-<%= counter.to_s %>">
                      <label for="appointment-<%= counter.to_s %>" class="radio-button-label"><%= appointment.date.strftime('%A, %d %b, %l:%M %p') %></label>
                      <% counter += 1 %>
                      <%= f.submit 'Book', class: 'btn-gradient-yellow' %>
                    <% end %>
                  <% end %>
                <% end %>
              </div>

              <%# <div class="modal-footer">
                <button type="button" class="btn btn-flat" data-dismiss="modal">Close</button>
                <%= link_to(req_index_path) do %>
                  <%# <button type="button" class="btn btn-gradient-yellow">Book</button> %>
                <%# <% end %>
              <%# </div> %>

            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>

  <div class="container column-right">
    <div id="map"
      data-markers="<%= @markers.to_json %>"
      data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>

</div>

<%#= simple_form_for appointment, data: {confirm: 'Are you sure you want to book this appointment?'} do |f| %>

<script>

// JAVASCRIPT

</script>
